# LightSync 快速开始指南

## 项目概述

LightSync 是一个轻量级跨设备文件同步工具，基于 Tauri + React + Rust 构建，支持 WebDAV 协议。

## 环境要求

- Node.js 18+ 和 pnpm
- Rust 1.70+
- Windows 10+, macOS 10.15+, 或 Linux

## 快速启动

### 1. 安装依赖

```bash
# 安装前端依赖
pnpm install

# Rust 依赖会自动下载
```

### 2. 开发模式运行

```bash
# 启动 Tauri 开发服务器
pnpm tauri:dev
```

这会同时启动：

- Vite 前端开发服务器 (http://localhost:1420)
- Tauri 应用窗口
- Rust 后端编译和热重载

### 3. 生产构建

```bash
# 构建前端和 Rust 后端
pnpm build

# 打包应用（生成可执行文件）
pnpm tauri build
```

## 项目结构

```
LightSync/
├── src/                          # 前端代码
│   ├── components/               # React 组件
│   ├── pages/                    # 页面组件
│   ├── layouts/                  # 布局组件
│   ├── router/                   # 路由配置
│   ├── i18n/                     # 国际化配置
│   ├── hooks/                    # 自定义 Hook
│   ├── utils/                    # 工具函数
│   ├── styles/                   # 样式文件
│   ├── App.tsx                   # 主应用组件
│   └── main.tsx                  # 入口文件
├── src-tauri/                    # Rust 后端代码
│   ├── src/
│   │   ├── lib.rs                # 库入口
│   │   ├── main.rs               # 应用入口
│   │   ├── error.rs              # 错误处理
│   │   ├── config.rs             # 配置管理
│   │   ├── config_watcher.rs     # 配置监听
│   │   ├── database.rs           # 数据库操作
│   │   └── system.rs             # 系统信息
│   ├── migrations/               # 数据库迁移
│   ├── Cargo.toml                # Rust 依赖
│   └── tauri.conf.json           # Tauri 配置
├── docs/                         # 文档
├── package.json                  # 前端依赖
├── tsconfig.json                 # TypeScript 配置
├── vite.config.ts                # Vite 配置
└── tailwind.config.js            # TailwindCSS 配置
```

## 核心功能

### Phase 1: 项目基础搭建 ✅ 已完成

- ✅ 项目初始化和依赖配置
- ✅ 统一错误处理系统
- ✅ 配置管理系统
- ✅ SQLite 数据库初始化
- ✅ 国际化系统搭建
- ✅ 基础 UI 框架搭建

### Phase 2-10: 后续功能

详见 `项目进度清单.md`

## 常用命令

```bash
# 开发
pnpm dev              # 启动前端开发服务器
pnpm tauri:dev        # 启动 Tauri 开发应用

# 构建
pnpm build            # 构建前端
pnpm tauri build      # 打包应用

# 代码质量
pnpm format           # 格式化代码
pnpm format:check     # 检查代码格式

# 类型检查
pnpm tsc              # TypeScript 类型检查
```

## 技术栈

### 前端

- **框架**: React 18.3
- **UI 库**: NextUI 2.4.8
- **样式**: TailwindCSS 3.4
- **路由**: React Router 7.9
- **国际化**: react-i18next 16.2
- **主题**: next-themes 0.4
- **图标**: lucide-react 0.553

### 后端

- **框架**: Tauri 2.0
- **语言**: Rust (Edition 2021)
- **异步**: Tokio 1.0
- **数据库**: SQLite 3.x
- **文件监控**: notify 6.0
- **错误处理**: thiserror 1.0

### 开发工具

- **构建**: Vite 7.0
- **类型检查**: TypeScript 5.8
- **代码格式**: Prettier 3.6
- **包管理**: pnpm 10.18

## 配置文件说明

### tauri.conf.json

- 应用窗口配置（大小、样式等）
- 构建和开发命令
- 安全策略配置
- 打包配置

### vite.config.ts

- 前端构建配置
- 开发服务器配置
- 插件配置

### Cargo.toml

- Rust 依赖管理
- 编译配置

## 数据库架构

### 表结构

1. **file_metadata** - 文件元数据表
   - 存储同步文件的元数据
   - 包含文件哈希、大小、修改时间等

2. **sync_logs** - 同步日志表
   - 记录所有同步操作
   - 包含操作类型、状态、错误信息等

3. **sync_sessions** - 同步会话表
   - 记录完整的同步会话
   - 包含会话统计信息

## 国际化支持

支持 21 种语言：

- 中文（简体、繁体）
- 英文、日文、韩文
- 俄文、德文、法文、西班牙文、意大利文
- 葡萄牙文（巴西、葡萄牙）
- 土耳其文、挪威文、波斯文、乌克兰文、阿拉伯文、希伯来文
- 泰米尔文、土库曼文

## 常见问题

### Q: 如何修改应用窗口大小？

A: 编辑 `src-tauri/tauri.conf.json` 中的 `windows` 配置。

### Q: 如何添加新的 Tauri 命令？

A: 在 `src-tauri/src/lib.rs` 中定义函数，使用 `#[tauri::command]` 宏，然后在 `invoke_handler` 中注册。

### Q: 如何修改数据库架构？

A: 在 `src-tauri/migrations/` 中创建新的迁移文件，遵循 `NNN_description.sql` 的命名规则。

### Q: 如何添加新的翻译？

A: 编辑 `src/i18n/locales/` 中对应语言的 JSON 文件。

## 调试技巧

### 查看 Tauri 日志

```bash
# 在开发模式下，日志会输出到控制台
# 生产环境日志位置：
# Windows: %APPDATA%/lightsync/logs
# macOS: ~/Library/Logs/lightsync
# Linux: ~/.local/share/lightsync/logs
```

### 使用浏览器开发者工具

```bash
# 在 Tauri 应用中按 F12 打开开发者工具
```

### 检查 Rust 编译错误

```bash
cd src-tauri
cargo check
```

## 下一步

1. 阅读 `项目进度清单.md` 了解完整的功能规划
2. 查看各个模块的源代码注释
3. 参考 Tauri 官方文档：https://tauri.app
4. 参考 React 官方文档：https://react.dev

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！
